<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
  <link rel="shortcut icon" href="Assets/Gemini.svg" type="image/x-icon">
  <title>To Do - Eco-Gemini</title>
</head>

<body>
  <header>
    <button id="darklight"><img id="lightdarkimg" src="Assets/Moon.svg" style="margin-bottom: -4.5px;" height="25"
        width="25"> Switch Mode</button>
    <ul id="end">
      <li class="hoverd"><a id="index" href="index.html" class="not-current"><img src="Assets/Home.svg" height="25"
            width="25" style="margin-bottom: -4px;"> Home</a></li>
      <li class="hoverd"><a id="ecohr" href="eco-gemini.html" class="not-current"><img src="Assets/Gemini.svg"
            height="25" width="25" style="margin-bottom: -4px;"> Eco-Gemini</a></li>
      <li><a class="current"><img src="Assets/Todo.svg" class="curimg" height="25" width="25"
            style="margin-bottom: -4px;  opacity: 0.5;"> To Do</a></li>
      <li class="hoverd"><a id="leadh" href="leaderboard.html" class="not-current"><img src="Assets/Leaderboard.svg"
            height="25" width="25" style="margin-bottom: -4px;"> Leaderboard</a></li>
      <li class="hoverd"><a id="about" href="about.html" class="not-current"><img src="Assets/About.svg" height="25"
            width="25" style="margin-bottom: -4px;"> About</a></li>
    </ul>
  </header>
  <div id="formdiv">
    <h1 class="main">Eco-To-Do</h1>
    <div id="tsk1d">
    <input type="checkbox" class="checkbox-round" name="tsk1c" itemid="checkbox" id="tsk1c"><label id="lab1"
      class="label" style="margin-left: -90%;">1.</label>
    <p class="task" id="tsk1tx">inpu</p></div>
    <div id="tsk2d">
      <input type="checkbox" class="checkbox-round" name="tsk2c" itemid="checkbox" id="tsk2c"><label id="lab2"
      class="label" style="margin-left: -90%;">2.</label>
    <p class="task">Plant <label class="keyword">1 tree</label>.</p></div>
    <div id="tsk3d">
      <input type="checkbox" class="checkbox-round" name="tsk3c" itemid="checkbox" id="tsk3c"><label id="lab3"
      class="label" style="margin-left: -90%;">3.</label>
    <p class="task">Make a <label class="keyword">research</label> about <label class="keyword">climate change</label>.
    </p></div>
    <div id="tsk4d">
    <input type="checkbox" class="checkbox-round" name="tsk4c" itemid="checkbox" id="tsk4c"><label id="lab4"
      class="label" style="margin-left: -90%;">4.</label>
    <p class="task">Use a <label class="keyword">bike</label> for transportation.</p>
    </div>
    <div id="tsk5d">
    <input type="checkbox" class="checkbox-round" name="tsk5c" itemid="checkbox" id="tsk5c"><label id="lab5"
      class="label" style="margin-left: -90%;">5.</label>
    <p class="task">Use <label class="keyword">Eco-Gemini</label> for <label class="keyword">10 minutes</label>.</p>
    </div>
    <br>
  </div>
  <script type="importmap">
    {
      "imports": {
        "@google/generative-ai": "https://esm.run/@google/generative-ai"
      }
    }
  </script>
  <script type="module">
    function setDayCookie(cname, cvalue) {
      var now = new Date();
      var expire = new Date();

      expire.setFullYear(now.getFullYear());
      expire.setMonth(now.getMonth());
      expire.setDate(now.getDate() + 1);
      expire.setHours(0);
      expire.setMinutes(0);
      expire.setSeconds(0);

      var expires = "expires=" + expire.toString();
      document.cookie = cname + "=" + cvalue + "; " + expires + "; path=/";
    }

    function setWeekCookie(cname, cvalue) {
      var now = new Date();
      var expire = new Date();

      expire.setFullYear(now.getFullYear());
      expire.setMonth(now.getMonth());
      expire.setDate(now.getDate() + 7);
      expire.setHours(0);
      expire.setMinutes(0);
      expire.setSeconds(0);

      var expires = "expires=" + expire.toString();
      document.cookie = cname + "=" + cvalue + "; " + expires + "; path=/";
    }

    function getCookie(cname) {
      let name = cname + "=";
      let decodedCookie = decodeURIComponent(document.cookie);
      let ca = decodedCookie.split(';');
      for (let i = 0; i < ca.length; i++) {
        let c = ca[i];
        while (c.charAt(0) == ' ') {
          c = c.substring(1);
        }
        if (c.indexOf(name) == 0) {
          return c.substring(name.length, c.length);
        }
      }
      return "";
    }

    function checkCookie(cname) {
      let cookie = getCookie(cname);
      if (cookie != "") {
        return true;
      } else {
        return false;
      }
    }

    if (checkCookie("tsk1")) {
      var tsk1 = (getCookie("tsk1").toLowerCase() === "true");
      document.getElementById("tsk1c").checked = tsk1;
    }
    else {
      var tsk1 = false;
      document.getElementById("tsk1c").checked = tsk1;
      setDayCookie("tsk1", tsk1)
    }

    if (checkCookie("tsk2")) {
      var tsk2 = (getCookie("tsk2").toLowerCase() === "true");
      document.getElementById("tsk2c").checked = tsk2;
    }
    else {
      var tsk2 = false;
      document.getElementById("tsk2c").checked = tsk2;
      setDayCookie("tsk2", tsk2)
    }

    if (checkCookie("tsk3")) {
      var tsk3 = (getCookie("tsk3").toLowerCase() === "true");
      document.getElementById("tsk3c").checked = tsk3;
    }
    else {
      var tsk3 = false;
      document.getElementById("tsk3c").checked = tsk3;
      setDayCookie("tsk3", tsk3)
    }

    if (checkCookie("tsk4")) {
      var tsk4 = (getCookie("tsk4").toLowerCase() === "true");
      document.getElementById("tsk4c").checked = tsk4;
    }
    else {
      var tsk4 = false;
      document.getElementById("tsk4c").checked = tsk4;
      setDayCookie("tsk4", tsk4)
    }

    if (checkCookie("tsk5")) {
      var tsk5 = (getCookie("tsk5").toLowerCase() === "true");
      document.getElementById("tsk5c").checked = tsk5;
    }
    else {
      var tsk5 = false;
      document.getElementById("tsk5c").checked = tsk5;
      setDayCookie("tsk5", tsk5)
    }

    if (checkCookie("tskpoint")) {
      var tskpoint = getCookie("tskpoint");
      // document.getElementsByClassName("task")[0].checked = tsk1;
    }
    else {
      var tskpoint = 0;
      // document.getElementsByClassName("task")[0].checked = tsk1;
      setWeekCookie("tskpoint", tskpoint)
    }

    if (checkCookie("random1")) {
      const randomElement = getCookie("random1");
      document.getElementsByClassName("keyword")[1].textContent = randomElement;
    }
    else {
      var array = [
        "a public area",
        "an empty area",
        "a street",
        "the nearest water body",
      ];
      const randomElement = array[Math.floor(Math.random() * array.length)];
      document.getElementsByClassName("keyword")[1].textContent = randomElement;
      setDayCookie("random1", randomElement)
    }

    if (checkCookie("random2")) {
      const randomElement = getCookie("random2");
      document.getElementsByClassName("keyword")[4].textContent = randomElement;
    }
    else {
      var array = [
        "climate change",
        "wildlife",
        "renewable energy",
        "biking environmental-benifits",
      ];
      const randomElement = array[Math.floor(Math.random() * array.length)];
      document.getElementsByClassName("keyword")[4].textContent = randomElement;
      setDayCookie("random2", randomElement)
    }

    var light;
    const urlParams = new URLSearchParams(window.location.search);
    const sharedData = urlParams.get("light");
    if (sharedData != 0 && sharedData != 1) {
      light = true;
    }
    else {
      if (sharedData == 0) {
        light = false;
      }
      if (sharedData == 1) {
        light = true;
      }
    }

    const delay = ms => new Promise(res => setTimeout(res, ms));

    async function visChange0() {
      document.getElementById("formdiv").style.opacity = "0";
      document.getElementById("formdiv").style.animationName = "curback";
      document.getElementById("formdiv").style.animationDuration = "0.2s";
    }

    async function visChange1() {
      document.getElementById("formdiv").style.opacity = "1";
      document.getElementById("formdiv").style.animationName = "revcurback";
      document.getElementById("formdiv").style.animationDuration = "0.19s";
    }

    document.getElementById("index").addEventListener("mouseover", () => visChange0())
    document.getElementById("index").addEventListener("mouseleave", () => visChange1())
    document.getElementById("ecohr").addEventListener("mouseover", () => visChange0())
    document.getElementById("ecohr").addEventListener("mouseleave", () => visChange1())
    document.getElementById("leadh").addEventListener("mouseover", () => visChange0())
    document.getElementById("leadh").addEventListener("mouseleave", () => visChange1())
    document.getElementById("about").addEventListener("mouseover", () => visChange0())
    document.getElementById("about").addEventListener("mouseleave", () => visChange1())
    document.getElementsByClassName("current")[0].addEventListener("mouseleave", () => visChange1())
    document.getElementsByClassName("current")[0].addEventListener("mouseover", () => visChange0())
    document.getElementsByClassName("current")[0].addEventListener("mouseup", () => visChange0())
    document.getElementById("darklight").addEventListener("click", () => light = !light)
    async function f2() {
      setDayCookie("tsk1", document.querySelectorAll("input[type=checkbox]")[0].checked)
      setDayCookie("tsk2", document.querySelectorAll("input[type=checkbox]")[1].checked)
      setDayCookie("tsk3", document.querySelectorAll("input[type=checkbox]")[2].checked)
      setDayCookie("tsk4", document.querySelectorAll("input[type=checkbox]")[3].checked)
      setDayCookie("tsk5", document.querySelectorAll("input[type=checkbox]")[4].checked)

      if (light == true) { // Light mode
        for (let index = 0; index < document.getElementsByClassName("task").length; ++index) {
          const element = document.getElementsByClassName("task")[index];
          element.style.color = "black";
        }
        for (let index = 0; index < document.getElementsByClassName("keyword").length; ++index) {
          const element = document.getElementsByClassName("keyword")[index];
          element.style.color = "rgb(145, 131, 105)";
        }

        for (let index = 0; index < document.getElementsByClassName("label").length; ++index) {
          const element = document.getElementsByClassName("label")[index];
          element.style.color = "black";
        }
        document.getElementById("formdiv").style.backgroundColor = "rgba(255, 255, 255, 0.8)"
        document.querySelector("ul").style.backgroundColor = "rgb(0, 255, 149)";
        document.querySelector("html").style.backgroundImage = "linear-gradient(to left, rgb(73, 151, 73), rgb(39, 216, 157))"
        document.getElementsByClassName("current")[0].style.color = "rgba(0, 0, 0, 1)";
        document.getElementsByClassName("not-current")[0].style.color = "rgba(0, 0, 0, 1)";
        document.getElementsByClassName("not-current")[1].style.color = "rgba(0, 0, 0, 1)";
        document.getElementsByClassName("not-current")[2].style.color = "rgba(0, 0, 0, 1)";
        document.getElementsByClassName("not-current")[3].style.color = "rgba(0, 0, 0, 1)";
        document.getElementById("darklight").style.backgroundColor = "rgb(0, 255, 149)";
        document.getElementById("darklight").style.color = "black";
        document.getElementById("lightdarkimg").src = "Assets/Moon.svg"
      }
      else if (light == false) { // Dark mode
        for (let index = 0; index < document.getElementsByClassName("task").length; ++index) {
          const element = document.getElementsByClassName("task")[index];
          element.style.color = "yellow";
        }
        for (let index = 0; index < document.getElementsByClassName("keyword").length; ++index) {
          const element = document.getElementsByClassName("keyword")[index];
          element.style.color = "rgb(195, 181, 155)";
        }

        for (let index = 0; index < document.getElementsByClassName("label").length; ++index) {
          const element = document.getElementsByClassName("label")[index];
          element.style.color = "yellow";
        }
        document.getElementById("formdiv").style.backgroundColor = "rgba(0, 0, 0, 0.8)"
        document.querySelector("html").style.backgroundImage = "linear-gradient(to left, rgb(23, 101, 23), rgb(0, 166, 100))";
        document.querySelector("ul").style.backgroundColor = "rgb(70, 124, 0)";
        document.getElementsByClassName("current")[0].style.color = "rgba(255, 255, 0, 1)";
        document.getElementsByClassName("not-current")[0].style.color = "rgba(255, 255, 0, 1)";
        document.getElementsByClassName("not-current")[1].style.color = "rgba(255, 255, 0, 1)";
        document.getElementsByClassName("not-current")[2].style.color = "rgba(255, 255, 0, 1)";
        document.getElementsByClassName("not-current")[3].style.color = "rgba(255, 255, 0, 1)";
        document.getElementById("darklight").style.backgroundColor = "rgba(70, 124, 0, 1)";
        document.getElementById("darklight").style.color = "yellow";
        document.getElementById("lightdarkimg").src = "Assets/Sun.svg"
      }
      switch (light) {
        case true:
          document.getElementById("index").href = "index.html?light=1";
          document.getElementById("ecohr").href = "eco-gemini.html?light=1";
          document.getElementById("leadh").href = "leaderboard.html?light=1";
          document.getElementById("about").href = "about.html?light=1";
          break;
        case false:
          document.getElementById("index").href = "index.html?light=0";
          document.getElementById("ecohr").href = "eco-gemini.html?light=0";
          document.getElementById("leadh").href = "leaderboard.html?light=0";
          document.getElementById("about").href = "about.html?light=0";
          break
      }
    }
    while (true) {
      f2();
      await delay(1);
    }
  </script>
</body>

</html>